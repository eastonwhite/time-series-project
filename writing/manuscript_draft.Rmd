---
bibliography: White_bib.bib
fontsize: 12pt
geometry: margin=1in
header-includes: \usepackage{float} \usepackage{lineno} \usepackage[firstinits=true,style=authoryear-comp,natbib=true,doi=false,isbn=false,url=false,uniquename=false,uniquelist=false,sorting=none]{biblatex}

 \linenumbers

output:
  pdf_document:
    fig_caption: yes
    keep_tex: yes
    number_sections: yes
  word_document: default
---


Running head: 
\vspace{3 mm}

Title: Minimum time required to detect population trends: the need for long-term monitoring programs
\vspace{7 mm}

Author(s): \textsc{Easton R. White$^{1,2}$} 
\vspace{3 mm}

Address:\emph{
    \\$^1$Center for Population Biology \\
    University of California, Davis \\
    2320 Storer Hall \\
		University of California, Davis \\
		One Shields Avenue Davis, CA, USA}
\vspace{3 mm}

$^2$Corresponding author: eawhite@ucdavis.edu, 1 480 203 7931
\vspace{3 mm}

Number of words (including 300 words for figures): X,XXX 
Number of figures:
Number of figures in supplementary material:
\vspace{3 mm}

To be submitted to: \emph{Biological Conservation}
\vspace{3 mm}

Available as a preprint at: www.peerj.com
\vspace{3 mm}

Color does not need to be used for any figures in print
\vspace{3 mm}



Keywords: ecological time series, experimental design, monitoring, power analysis, statistical power, sampling design

\vspace{3 mm}



\pagebreak 

\linenumbers

 
\begin{abstract}
Long-term census data are necessary to better understand ecological processes and make management decisions. However, census data are often expensive, requiring a lot of time and resources. Little work has addressed the question: when is a time series of census data long enough to address a question of interest? <!--Here, we explore two approaches to address this question: simulations and an empirical approach.--> We determine the minimum time series length required to estimate significant increases or decreases in population abundance. Importantly, we examine the ability to detect a trend with a set level of statistical power, which is often neglected in ecological time series analyses. Using a simulation approach, we demonstrate how the minimum time series length required increases with weaker trends in abundance and with higher population variability. In addition, we examine 878 populations of vertebrate species to determine the minimum time required to detect changes in their abundance. We show that 10-15 years of continuous monitoring are required in order to achieve a high level of statistical power. Similar to simulation-approaches, the minimum time required for field census data strongly depends on trend strength, population variability, and temporal autocorrelation. <!--Perhaps surprisingly, the minimum time required did not correlate well with biological explanatory variables, like body size or generation length.--> These results point to the importance of sampling populations over long periods of time. <!--We stress the need for verifying a study has enough statistical power to accurately determine long-term population trends.--> Time series less than 10-15 years are likely under-powered and potentially misleading.
\end{abstract}



# Introduction


Observational studies and population time series have become a cornerstone of modern ecological research and conservation biology [@Magurran2010; @Hughes2017]. Long-term data are necessary to both understand population dynamics and to assess species extinction risk (citations). Even though many time series may now be considered "long-term" (e.g. continuous plankton recorder @Giron-Nava2017), most are still short. Time series are typically short for a variety of reasons. They are often coupled with an experiment, which may only last a couple of years. In addition, short funding cycles make it difficult to examine populations over longer periods of time [@Hughes2017]. 

How long of a time series is actually necessary? This question has important implications for both research and management. Scientists need to know the time series length required to address a specific question. A short time series may lead to wrong conclusions given large natural year-to-year variability (citations). Managers need to know when action is needed for a population. Therefore, they must understand when population trend over time is actually meaningful. The IUCN Red List Categories and Criteria suggest, under Criterion A2, a species qualifies as vulnerable if it has experienced a 30% decline over 10 years, or 3 generations [@IUCN2012]. For both scientific and management questions, because sampling is typically expensive, we also do not want to sample for longer than is necessary [@Gerber1999].

An important step in experimental design is to determine the number of samples required. For any particular experiment four quantities are intricately linked: significance level ($\alpha$), statistical power, effect size, and sample size [@Legg2006]. The exact relationship between these quantities depends on the specific statistical test. A type I error is a false positive, or incorrect rejection of a true null hypothesis. For example, if a time series was assessed as significantly increasing or decreasing---when there was no true significant trend---this would be a false positive. The false positive rate, or significance level ($\alpha$) is often set at 0.05. A type II error ($\beta$) is failure to detect a true trend, or failure to reject a false null hypothesis. Formally, statistical power ($1-\beta$) is one minus the probability of a type II error ($\beta$). The effect size is a measure of the difference between two groups. Prior to an experiment, one could set appropriate levels of power, significance level, and the effect size to estimate the sample size required for the experiment. This approach, however, is not straight-forward for a time series, or more complicated scenarios [@Johnson2015], as data are clearly non-independent. 

For time series data, two general approaches to estimating sample size are appropriate. <!--Typically, calculations of sample size are given by a formula specific to standard statistical tests (e.g. t-test). However, many ecological scenarios require the use of simulations [@Bolker2008; @Johnson2015]. As a first approach,-->Simulations can be designed for a specific population and question [@Bolker2008; @Johnson2015]. Simple models can be simulated with parameter values corresponding to a population of interest [@Gerrodette1987]. Statistical power can then be calculated as the fraction of simulations that meet some criteria. The specific criteria depend on the question at hand. For example, given a time series, when is the slope from linear regression significantly different from zero? In other words, when is the time series significantly increasing or decreasing? It is then possible to determine how power changes with a variable of interest. For example, time series are simulated for different lengths of time. From these simulations, the minimum time series length required is calculated to meet certain levels of statistical significance and power [@Bolker2008]. 

In addition to using simulations, empirical time series can also be used. Multiple replicates of similar populations are usually not available, but it is possible to subsample an empirical time series [@Gerber1999]. Subsamples of different lengths can then be evaluated to see which fraction of subsamples meet some criteria, again a measure of statistical power. Similar to the simulation approach, we can use these measures of power to determine the minimum time series required for a particular question of interest.

Past work has investigated questions related to the minimum time series required to estimate trends in population size over time [@Giron-Nava2017]. For example, @Rhodes2011 examined the optimal allocation of effort between spatial and temporal replicates. Using simple populations models, they found that the allocation of effort depends on environmental variation, spatial and temporal autocorrelation, and observer error. @Rueda-Cediel2015 also used a modeling approach, but parameterized a model specifically for a threatened snail, \emph{Tasmaphena lamproides}. They found that for this short-lived organism, 15 years was adequate to assess long-term trends in abundance. In addition, @Hatch2003 examined seabird populations and determined the minimum time required to achieve high statistical power ranged between 11 and 69 years. However, these studies, and other past work, have typically focused either on theoretical aspects of monitoring design or focused on only a few species.

We use both simulations and a database of empirical time series to determine the minimum number of years required to address several questions. We estimate the minimum time series length required ($T_{min}$) to assess long-term changes in abundance via simple linear regression. First, we estimate $T_{min}$ using a simulation approach. Then we examine 878 population time series to estimate $T_{min}$. In the supplementary material, we determine $T_{min}$ for related ideas: calculating long-term growth rates, using more complicated population models, varying statistical level and power, and the use of generalized additive models.


# Methods

## Simulation approach

One approach to determining the minimum time series length needed is through repetitive simulations of a population model [@Gerrodette1987]. This is the same approach one might use in sample size calculations for any experimental design too complicated for simple power analyses [@Bolker2008;@Johnson2015]. We only briefly discuss this approach as it has been described elsewhere. Essentially, we use a population model and repetitively simulate it for a number of years. This approach requires us to determine values for our model parameters (e.g. population variability). As an example, we can take the following population model for population size $N$ at time $t$:

\begin{equation}
N(t + 1) = N(t) + r(t) \mbox{ with } r(t) \sim N(\mu, \sigma)
\label{sim_model}
\end{equation}
where $\epsilon$ is a normally-distributed random noise term with mean $\mu$ and standard deviation $\sigma$. The rate of growth $r$ is also the trend strength of the increase or decrease (i.e. the rate of increase). It is important to note that any population model could be subsituted for equation \ref{sim_model}, as we do in the supplementary material (Figs. \ref{fig:min_time_dist_log_pop}, \ref{fig:shark_example}). 

Statistical power is then the fraction of simulations that meet some criteria. Here, we use whether the slope parameter from linear regression is significant. Statistical power changes with the simulation length (Fig. \ref{fig:theoretical_approach}b). Then, the minimum time required ($T_{min}$) is the number of years needed to obtain statistical power above some threshold (historically at 0.8, @Cohen1992). Statistical power of 0.8 would indicate that, if there was a true trend in abundance, we would have a 0.8 probability of detecting the trend. We also tested the effect of varying both the significance level and statistical power (Fig. \ref{fig:min_time_vs_alpha_beta}).

In Fig. \ref{fig:theoretical_approach}a, a number of simulated time series are shown for a set number of time periods ($t=40$). It is clear that statistical power increases quickly with increases in length of time sampled (Fig. \ref{fig:theoretical_approach}b). Where power is greater than 0.8 (the dotted line), that is the minimum time required ($T_{min}$). 


```{r,echo=F,eval=T,fig.cap='(a) Example of a simulated time series for 40 time periods. (b) Statistical power versus the simulated time series length. The horizontal, dashed line is the desired statistical power of 0.8. The vertical, dashed line is the minimum time required to achieve the desired statistical power. (c) Minimum time required ($T_{min}$) for simulations with different values of the trend strength ($r$). (d) Minimum time required for different levels of population variability ($\\sigma$). In each case, the minimum time required is the minimum number of years to achieve 0.8 statistical power given a significance level of 0.05.\\label{fig:theoretical_approach}'}
source("../scripts/theoretical-models/calculate_power.R")
source("../scripts/theoretical-models/simulate_pop.R")


  # years_to_sample=seq(2,100,by=1)
  # power=lapply(X=years_to_sample,FUN = calculate_power,phi = 0.6,r=0.2,sigma = .5,trials=100)#should use 300+ trials
  # 
  # simulations = replicate(n=30,simulate_pop(phi = 0.6,r=0.2,sigma = .5,max.time=100))
  # min_time_needed = years_to_sample[tail(which(power<0.8),1)] + 1
  # 
  # save(simulations,years_to_sample,power,min_time_needed,file='../analysis-outputs/example_simulations_fig1.Rdata')
  load('../analysis-outputs/example_simulations_fig1.Rdata')
  
  #load command
  # Plotting commands
  par(mfrow=c(2,2),oma=c(1.5,2,0.5,0.5),mar=c(3,5,2.5,0.5))
    matplot(simulations,type='l',col=rgb(0.5,0.5,0.5,0.5),lty=1,ylab='',xlab='',las=1,cex.axis=1.2)
      mtext(text = 'time' ,side = 1,cex = 1.2,line=3)
      mtext(text = 'population size' ,side = 2,cex = 1.2,line=3.5)
      mtext(text = '(a)',side = 3,line = -1.2,adj=0.05,font = 2,cex=1.2)
  
    plot(years_to_sample,power,type='l',lwd=2,las=1,ylab='',xlab='',cex.axis=1.2)
      abline(v=min_time_needed,lty=2,lwd=2,col='black')
      abline(h=0.8,lty=2,lwd=2,col='black')
      mtext(text = 'time sampled' ,side = 1,cex = 1.2,line=3)
      mtext(text = 'statistical power' ,side = 2,cex = 1.2,line=3)
      mtext(text = '(b)',side = 3,line = -1.2,adj=0.05,font = 2,cex=1.2)
      
    #   
    # # Plot versus trend strength
    #   r_values = seq(1,3,by=0.1) #by=0.2
    #   sigma_values=seq(1,7,by=0.3) #by=0.2
    # 
    #   parameter_combinations = expand.grid(r_values,5)
    #   parameter_combinations$min_time_required = NA
    #   names(parameter_combinations)= c('r','sigma','min_time_required')
    #   
    #   for (i in 1:nrow(parameter_combinations)){
    #     years_to_sample=seq(2,50,by=1)
    #     y=lapply(X=years_to_sample,FUN = calculate_power,phi =0.5,r=parameter_combinations$r[i],sigma = parameter_combinations$sigma[i],trials=150)
    #     if (length(tail(which(y<0.8),1))>0){
    #     parameter_combinations$min_time_required[i] = years_to_sample[tail(which(y<0.8),1)] + 1
    #     }
    #     #print(i)
    #   }
    #   
    #   save(parameter_combinations,file='../analysis-outputs/min_time_vs_trend_strength.Rdata')
      load('../analysis-outputs/min_time_vs_trend_strength.Rdata')
      
      plot(parameter_combinations$r,parameter_combinations$min_time_required,type='l',lwd=2,las=1,ylab='',xlab='',cex.axis=1.2,ylim=c(0,50))
      mtext(text = 'trend strength (slope coefficient)' ,side = 1,cex = 1.2,line=3)
      mtext(text = expression(T[min]) ,side = 2,cex = 1.2,line=3)
      mtext(text = '(c)',side = 3,line = -1.2,adj=0.05,font = 2,cex=1.2)
      
      # 
      # 
      # 
      # # Plot versus sigma values
      # parameter_combinations = expand.grid(1.5,sigma_values)
      # parameter_combinations$min_time_required = NA
      # names(parameter_combinations)= c('r','sigma','min_time_required')
      # 
      # for (i in 1:nrow(parameter_combinations)){
      #   years_to_sample=seq(2,50,by=1)
      #   y=lapply(X=years_to_sample,FUN = calculate_power,phi =0.5,r=parameter_combinations$r[i],sigma = parameter_combinations$sigma[i],trials=150)
      #   if (length(tail(which(y<0.8),1))>0){
      #   parameter_combinations$min_time_required[i] = years_to_sample[tail(which(y<0.8),1)] + 1
      #   }
      #   #print(i)
      # }
      
      #save(parameter_combinations,file='../analysis-outputs/min_time_vs_pop_var.Rdata')
      load('../analysis-outputs/min_time_vs_pop_var.Rdata')
      plot(parameter_combinations$sigma,parameter_combinations$min_time_required,type='l',lwd=2,las=1,ylab='',xlab='',cex.axis=1.2,ylim=c(0,50))
      mtext(text = 'population variability' ,side = 1,cex = 1.2,line=3)
      mtext(text = expression(T[min]) ,side = 2,cex = 1.2,line=3)
      mtext(text = '(d)',side = 3,line = -1.2,adj=0.05,font = 2,cex=1.2)
```







<!-- code to pull in databases-->
```{r, echo=F}
# Pull in original database from Keith et al. 2015 and the cleaned version after our series of filtering steps

#Load keith et al. database (from GPDD database)
  load('../data/Keith_et_al_2015_data.Rdata')

#Load our cleaned data (see other code for cleaning steps)
  load('../cleaned-data/cleaned_timeseries_database_with_min_time_linear_regression.Rdata') #Do i need to filter out non-significant populations as well (where no trend was present)
 # pop_info=pop_info[pop_info$trend_p_value<0.05,]
 # long_dat=subset(long_dat,long_dat$ID %in% pop_info$ID)
 # long_time_names=subset(long_time_names,long_time_names %in% pop_info$ID)
```



## Data source
We use a database of `r length(table(dat$ID))` population time series compiled in [@Keith2015] to compare the predictability of growth rates amongst populations. The data are originally from the Global Population Dynamics Database [@GPDD2010]. We filtered out short time series (less than `r pop_info$series_length[1]` years), and those with missing data, and were left with `r nrow(pop_info)` time series. The data includes information on `r length(table(pop_info$Binomial))` vertebrate species with a focus on mammals, birds, and fish. The data also includes information on generation length and census specifications. For each time series, we also calculated variables of interest like variance in population size, long-term trend in abundance (slope coefficient from simple linear regression), and temporal autocorrelation. <!--Lastly, we also calculated the minimum number of years required (10 years or 3 generations) under IUCN Red List Criterion A2 to classify a species as vulnerable [@IUCN2012].-->



```{r,echo=F}
# Pull in results of biological characteristics comparison to min time series length required
load('../cleaned-data/combined_databases_with_min_time_linear_regression.Rdata')
```
For a subset of populations ($n =$ `r nrow(LPI_pop_info)`), we had information on biological characteristics from another paper [@Myhrvold2015], including body size and generation length. All `r nrow(LPI_pop_info)` populations were birds. We examine how the minimum time required is related to these biological characteristics (Fig. \ref{fig:biological_correlates}). 



## Empirical approach

<!--Our objective is to determine the minimum time series length ($T_{min}$) required to answer a specific question of interest. As we describe below, the minimum time series length calculation is particular to each question. Intuitively, we might expect a longer minimum time series length ($T_{min}$) required given more complicated questions (citations).-->

We assume that each time series in our database is long enough to include all necessary information (e.g. variability) about the population. In other words, each time series is a representative sample. We first take all possible contiguous subsamples of each time series. For example, a time series of 35 years would have 34 possible contiguous subsamples of length 2, 34 possible contiguous subsamples of length 3, and continuing until 1 possible contiguous subsample of length 35 [@Gerber1999; @Giron-Nava2017]. Next, we run a linear regression for each subsampled time series. Then, we determine the fraction of subsamples of a particular length that have estimated slope coefficients which are statistically different from zero. We only look at the fraction of samples where the long-term, or ``true'', time series also has a significant slope. This fraction is a measure of statistical power. Lastly, we determine which subsample length is required to achieve a certain threshold of statistical power (0.8, @Cohen1992). The subsampled length meeting these criteria is the minimum time series length required ($T_{min}$).    

In the supplementary material, we show how the same approach described here can be used to determine the minimum time required to estimate a population's geometric growth rate (Figs. \ref{fig:growth_rate},\ref{fig:min_time_growth_dist}). We also determine the minimum time required to estimate long-term trends according to generalized additive models, instead of the simple linear models used here (Fig. \ref{fig:gam_example}). We found that although we obtain a similar distribution of minimum times required for GAMs, the minimum time required for GAMs is on average shorter than for linear regression (Fig. \ref{fig:min_time_dist_gam}).


<!--
## Questions addressed in the appendix

We also examine how minimum time series calculations changed depending on the question of interest. In the supplementary material, we use similar calculations to determine the minimum time series required to estimate overall population growth rate (Fig. \ref{fig:growth_rate}). We also explore how the method can be applied to more biologically-realistic population models (Fig. \ref{fig:shark_example}. More specifically, we determine the minimum time required to estimate long-term population trends using a stochastic, age-structured model of lemon shark population dynamics in the Bahamas [@White2014]. Lastly, we determine the minimum time required to estimate long-term trends according to generalized additive models, instead of the simple linear models used here.
-->







# Results


We determined the minimum time series length ($T_{min}$) required to address a particular question of interest. What is the minimum time series length required to determine, via linear regression, the long-term population trend? Here, the minimum time series length required had high enough statistical power ($1-\beta$ greater than 0.8) for a set significance level ($\alpha$) of 0.05. It is also possible to alter $1-\beta$ and $\alpha$. Predictably, as we increased our level of power or decreased $\alpha$, $T_{min}$ increased (Fig. \ref{fig:min_time_vs_alpha_beta}). We investigated this question through two approaches. We briefly describe results from the simulation approach and then discuss our empirical approach.


## Simulation approach

We constructed a general population model where the trend strength (i.e. slope coefficient) over time could be a model parameter. We then ran simulated time series of different lengths. From these simulations we determined the minimum time series length required to achieve a certain level of statistical power. In line with past work [@Gerrodette1987], we found the $T_{min}$ increases (i.e. more time is required) with decreases in trend strength and with increases in population variability (Figs. \ref{fig:theoretical_approach}c,d). 

We chose a simple model, but any other population model could be used (see example in Fig. \ref{fig:min_time_dist_log_pop}). Ideally, the specific model choice should be tailored to the population of interest. We explored how the simulation approach can be applied to more biologically-realistic population models (Fig. \ref{fig:shark_example}). More specifically, we determined the minimum time required to estimate long-term population trends using a stochastic, age-structured model of lemon shark population dynamics in the Bahamas [@White2014]. We found that over 27 years of continuous monitoring were needed in this particular scenario (Fig. \ref{fig:shark_example}). Similar to the simulation approach decribed above, the minimum time required for the lemon shark population was strongly dependent on model parameters. 

## Empirical approach

```{r,echo=F,fig.cap='Distributions of the minimum time required for four different biological classes. The minimum time required calculation corresponds to a significant level of 0.05 and statistical power of 0.8.\\label{fig:min_time_dist}',fig.width=6}
# Pull in analysis of average min time needed for **empirical species** (save analysis as Rdata file or something)
 load("../cleaned-data/cleaned_timeseries_database_with_min_time_linear_regression.Rdata")

#only look at pops with significant long-term declines or increases
#pop_info=pop_info[pop_info$trend_p_value<0.05,]
#long_dat=subset(long_dat,long_dat$ID %in% pop_info$ID)
#long_time_names=subset(long_time_names,long_time_names %in% pop_info$ID)

#plot(density(pop_info$min_time_for_power),las=1,ylab='',xlab='',cex.axis=1.2,main='')

counts <- table(pop_info$class,pop_info$min_time_for_power)
barplot(counts, main=" ",
        xlab=" ", ylab="", col=gray.colors(4),
        ylim=c(0,50),xlim=c(0,40),
        las=1,cex.names =1.2,cex.axis = 1.2,#density=35,
        angle=c(20,40,60,80))
legend('topright',legend=rownames(counts),col = gray.colors(4),pch = 15,bty ="n")

mtext(text = 'Frequency',2,line=3,cex=1.2)
mtext(text = 'Minimum time required',1,line=3,cex=1.2)
```

 

```{r poisson_model, echo=F,include=F}
# I should put this in the appendix
#Poisson regression
pop_info$abs_overall_trend = abs(pop_info$overall_trend)
poisson_model <-glm(min_time_for_power~ abs_overall_trend + autocorrelation + variance + gen_len,family = 'poisson',data=pop_info)
par(mfrow=c(2,2),mar=c(5,5,1,2),oma=c(0,0,0.5,0))
#plot(poisson_model,cex.lab=1.2,las=1,cex.axis=1.2,main=' ')

#R^2 calculation (pg. 218 Zuur)
R2 <- 100*(poisson_model$null.deviance - poisson_model$deviance)/(poisson_model$null.deviance)

```



```{r,echo=F, fig.cap='Minimum time required to estimate change in abundance correlated with (a) trend strength (absolute value of slope coefficient estimated from linear regression), (b) population variance (interannual variability in population size), and (c) temporal lag-1 autocorrelation.\\label{fig:correlates}',fig.height=7, fig.width=4}

# Plot minimum time required against trend strength, population variance, and autocorrelation  
  par(mfrow=c(3,1),mar=c(3,2,2,1),oma=c(1,4.5,0,0.5))
  plot(abs(pop_info$overall_trend),pop_info$min_time_for_power,pch=16,col=rgb(0.5,0.5,0.5,0.5),las=1,ylab='',xlab='',cex.axis=1.2)
  mtext('| trend strength |',1,line=3,cex=1.2)
  mtext('(a)',3,line=-1.5,adj = 0.985,cex=1.2,font = 2)
    plot(pop_info$variance,pop_info$min_time_for_power,pch=16,col=rgb(0.5,0.5,0.5,0.5),las=1,ylab='',xlab='',cex.axis=1.2)
    mtext('population variance',1,line=3,cex=1.2)
    mtext('(b)',3,line=-1.5,adj = 0.985,cex=1.2,font = 2)
      plot(pop_info$autocorrelation,pop_info$min_time_for_power,pch=16,col=rgb(0.5,0.5,0.5,0.5),las=1,ylab='',xlab='',cex.axis=1.2)
      mtext('autocorrelation',1,line=3,cex=1.2)
       mtext('(c)',3,line=-1.5,adj = 0.985,cex=1.2,font = 2)
       mtext('minimum time required',2,line=2.5,cex=1.2,outer = T)

  
  
```


We examined a database of `r nrow(pop_info)` separate population time series representing `r length(table(pop_info$Binomial))` species. This database consists of vertebrate species with a variety of life history characteristics (Fig. \ref{fig:biological_correlates}). We limited our analyses to populations with at least 35 years of continuous sampling. We then examined the minimum time required to estimate long-term trends via linear regression.

Across all the populations we examined, we found an average minimum time series length required ($T_{min}$) of `r round(mean(pop_info$min_time_for_power),1)` ($\sigma$=`r round((var(pop_info$min_time_for_power))^0.5,1)`), with a wide distribution (Fig. \ref{fig:min_time_dist}). Estimates of $T_{min}$ varied between biological class (Fig. \ref{fig:min_time_dist}). Ray-finned fish (class Actinopterygii) typically had estimates of $T_{min}$ over 20 years. Birds (class Aves) had a much wider distribution of $T_{min}$, but usually required less years of sampling. Differences between these classes were explained by differences in interannual variability in population size (Fig. \ref{fig:class}). We also examined a subset of populations where life-history characteristics were known. None of these explanatory variables were predictive of the minimum time series length required (Fig. \ref{fig:biological_correlates}). 


The minimum time series length required was strongly correlated with trend strength, population variance, and autocorrelation (Fig. \ref{fig:correlates}). This is in line based on our simulations and those of others [@Rhodes2011]. Using a generalized linear model, with a Poisson error structure, all three of these explanatory variables were significant and had large effect sizes (see Table A1). Combined, trend strength, population variance, and autocorrelation account for about `r round(100*(poisson_model$null.deviance - poisson_model$deviance)/(poisson_model$null.deviance),1)`% of the explained deviance, which is similar to $R^2$ [@Zuur2009], in minimum time series length required.

Lastly, we tested model sensitivity by using generalized additive models (GAMs) instead of simple linear regression. Again, we examined the minimum time required to estimate long-term population trends (Fig. \ref{fig:gam_example}). We found that although we obtain a similar distribution of minimum times required for GAMs, the minimum time required for GAMs is on average shorter than for linear regression (Fig. \ref{fig:min_time_dist_gam}).


```{r,echo=F,include=FALSE,eval=FALSE,fig.cap='Minimum time series required versus the generation length of each species\\label{fig:generation_length}'}
par(mfrow=c(1,1))
  plot(pop_info$gen_len,pop_info$min_time_for_power,pch=16,col=rgb(0.5,0.5,0.5,0.5),las=1,ylab='',xlab='',cex.axis=1.2)
  mtext('generation time (years)',1,line=3,cex=1.2)
  mtext('minimum time required',2,line=2.5,cex=1.2,outer = F)
```
    












# Discussion

We explored two different approaches to estimate the minimum time series length required to address a particular question of interest. We specifically asked, what is the minimum time series length required to determine long-term population trends using linear regression? This is one of the simplest questions one could ask of a time series. We would expect more involved questions (e.g. detecting chaos) to require a larger minimum time series length. The simulation-based approach has been suggested by others, especially in situations more complicated than that suited for classic power analysis [@Gerrodette1987;@Johnson2015;@Bolker2008]. Our simulations support past work that longer time series are needed when the trend strength (i.e. rate of increase or decrease) is weak or when population variability is high [@Gerrodette1987].

Here, we focus on an empirical approach to estimate the minimum time series length required to assess changes in abundance over time. We examined long time series and then subsampled each to determine the minimum time required to achieve a desired level of significance and power for linear regression. Statistical power is important as it provides on information as to the necessary samples required to determine a significant trend [@Legg2006]. We found that for `r nrow(pop_info)` populations, at least 10-15 years of continuous monitoring were necessary (Fig. \ref{fig:min_time_dist}). This time frame is in line with past work on a short-lived snail species [@Rueda-Cediel2015] and a long-lived whale species [@Gerber1999]. In line with theoretical predictions [@Rhodes2011], we also found $T_{min}$ was strongly correlated with the trend strength, variability in population size, and temporal autocorrelation (Fig. \ref{fig:correlates}). Contrary to our prior expectations, we also found that $T_{min}$ did not correlate with any biological variables of interest (Fig. \ref{fig:biological_correlates}). We initially hypothesized that species with longer lifespans or generation times may require a longer sampling period. Our result could have been a result of at least two effects. First, the database we used may not include a diverse enough set of species with different life history traits. Second, the question we poised, whether a population is increasing or decreasing, was specifically concerned with trends in population density over time. Therefore, life-history characteristics may be more important for other questions (e.g. species extinction risk) where estimates minimum time required are needed. 

There has been interest in determining the minimum time series length in the bird research community [@Hatch2003; @Bart2004; @Seavy2007]. For example, @Hatch2003 used seabird monitoring data to estimate the minimum time needed to achieve appropriate levels of power. He found that the minimum time required ranged between 11 and 69 years depending on species, trend strength, and study design. Similarly, @Bart2004 recommended a standard of 80% power to detect a 50% decline over 20 years in landbird populations. They found that only about 42% of populations in the Breeding Bird Survey met their criteria. @Seavy2007 asked whether statistical power was even a useful framework for assessing long-term population trends. They used 24 years of census data on Red-tailed Tropicbirds (\emph{Phaethon rubricauda}) in Hawaii and showed that to detect a 50% decline over 10 years almost always resulting in high statistical power (above 0.8). Therefore, they cautioned against only using power analyses to design monitoring schemes and instead argued for metrics that would increase precision. For example, @Seavy2007 suggest improving randomization, reducing bias, and increases detection probability when designing and evaluating monitoring programs.


An important related question, is the optimal allocation of sampling effort in space versus time. In a theoretical investigation of this question, @Rhodes2011 found that the optimal allocation of sampling depended strongly on temporal and spatial autocorrelation. If spatial population dynamics were highly correlated, then it was better to sample more temporally, and vice versa. Our work supports this idea as populations with strong temporal autocorrelation needed less years of sampling (Fig. \ref{fig:correlates}). @Morrison2008 also studied the optimal allocation of sampling effort in space versus time, but used emprical data from a long-term census of the collared pika (\emph{Ochotona collaris}) found in the Yukon. They estimated long-term growth rates among three subpopulations over a 10-year period. They found that censuses less than 5 years may be misleading and that extrapolating from one population to another, even when nearby geographically, may be untenable.




<!--
@Rueda-Cediel2015 found that 10-15 years was adequate to characterize population trends in a short lived animal. They used a matrix model of a particular species...


@Gerber1999 investigated the minimum time series required to estimate population growth of an endagered, but recovering, species. They used a long-term census to retroactively determine the minimum time series required to assess threat status. They found that only XX years were needed, XX years before the delisting decision was actually made. This highlights the importance of estimating the minimunm time series required as an earlier decision would have saved time and money [@Gerber1999].
-->



## Limitations

Our work has some limitations in determining the minimum time series length required. First, $T_{min}$ is particular to the specific question of interest. For example, in the supplementary material, we used generalized additive models to detect population trends and came up with a similar, but quantitatively different value for $T_{min}$ (Fig. \ref{fig:min_time_dist_gam}). An additional complication is that for our empirical approach, the subsampling of the full time series allows for estimates of power, but the individual subsamples are clearly not independent of one another. Further, estimates of $T_{min}$ depend on chosen values of $\alpha$ and $\beta$ (Fig. \ref{fig:min_time_vs_alpha_beta}). In an ideal setting, we would build a specific population model parameterized for each population of interest. Then, model simulations could be used to estimate the minimum time series required to address each specific question of interest. Clearly, this is not always practical, especially if conducting analyses for a wide array of species as we do here. In addition, our statistical models suggest that $T_{min}$ does not correlate with any biological variables of interest, at least for the question of linear regression (Fig. \ref{fig:biological_correlates}). Therefore, it is not possible to use these results to predict $T_{min}$ for another population, even if the population is of a species with a similar life-history to one in our database. 

## Conclusions

We use a database of `r nrow(pop_info)` populations to determine the minimum time series length required to determine population trends. This goes beyond previous work that either focused on theoretical investigations or a limited number of species. We show that to identify long-term changes in abundance, 10-15 years of continuous monitoring are required (Fig. \ref{fig:min_time_dist}). In line with theoretical predictions [@Gerrodette1987], we also show that $T_{min}$ is strongly correlated with the long-term population trend (i.e. rate of increase), variability in population size, and the temporal autocorrelation (Fig. \ref{fig:correlates}). Our work implies that for many populations, census data less than 10-15 years are probably not reliable. This stresses the importance of long-term monitoring programs. From both a scientific and management perspective estimates of $T_{min}$ are important. If a time series is too short we lack statistical power to reliably detect long-term population trends. In addition, a time series that is too long may be a poor use of already limited funds [@Gerber1999]. Future work should examine other species, with a wider range of life history characteristics. In addition, similar approaches can be used to determine the minimum time series length required to address additional questions of interest. 


<!--
## Time series length recommendations from other papers

- greater than 5 years [@Morrison2008]
- more than 10-15 years [@Rueda-Cediel2015]
- general advice (variability, correlations) [@Rhodes2011]
- more than 10 years [@Gerber1999]
- specific recommendations depend on amount of power and strength of trend (Bart 2004, Hatch 2003) [@Seavy2007]
- paper on syncrony from James
-->

# Supporting Information

In the supporting material, we provide an expanded methods sections, additional figures, minimum time calculations for determining exponential growth, simulations with a more complicated population model, minimum time calculations for determining long-term growth rates, and the use of generalized additive models to identify population trends. All code and data can be found at www.github.com/erwhite1

# Acknowledgements

ERW was partially supported by a National Science Foundation Graduate Fellowship. We would like to thank members of the Ecological Theory group at the University of California, Davis for their insight. We would also like to thank T. Dallas and E. Malcolm-White <!--X anonymous reviewers -->for their helpful comments. 

# References

<div id="refs"></div>


\clearpage

# Supplementary material

 \setcounter{figure}{0}
 \renewcommand{\thefigure}{A\arabic{figure}}
 
\begin{figure}[htbp]
\centering
\caption{(a) Population size of Bigeye tuna (\emph{Thunnus obesus}) over
time. The line is the best fit line from linear regression. (b)
Statistical power for different subsets of the time series in panel
a.\label{fig:empirical_approach_example}}
\end{figure}



\begin{figure}[htbp]
\centering
\caption{Output of generalized linear model with a Poisson error
structure for predicting the minimum time required with explanatory
variables of the absolute value of the slope coefficient (or trend
strength), temporal autocorrelation, and variability in population
size.\label{fig:poisson_model}}
\end{figure}

\begin{figure}[htbp]
\centering
\caption{Minimum time required versus (a) generation length (years), (b)
litter size (n), (c) adult body mass (grams), (d) maximum longevity
(years), (e) egg mass (grams), and (f) incubation (days). The lines in
each plot represent the best fit line from linear
regression.\label{fig:biological_correlates}}
\end{figure}

\begin{figure}[htbp]
\centering
\caption{(a) Minimum time required to estimate change in abundance for
species class, (b) long-term trend (estimated slope coefficient) by
species class, (c) inter-annual variability in population size by species
class, and (d) temporal autocorrelation by species
class.\label{fig:class}}
\end{figure}


\begin{figure}[htbp]
\centering
\caption{Minimum time required to assess long-term trends in abundance
for values of statistical significance (\(\alpha\)) and power
(\(1-\beta\)).\label{fig:min_time_vs_alpha_beta}}
\end{figure}

\begin{figure}[htbp]
\centering
\caption{Distribution of the minimum time required in order to detect a
significant trend (at the 0.05 level) in log(abundance) given power of
0.8.\label{fig:min_time_dist_log_pop}}
\end{figure}

\begin{figure}[htbp]
\centering
\caption{Statistical power for different length of time series
simulations for a lemon shark population in Bimini,
Bahamas.\label{fig:shark_example}}
\end{figure}

\begin{figure}[htbp]
\centering
\caption{Example of calculating minimum time required for growth rate
estimation. (a) European herring gull (\emph{Larus argentatus}) scaled
density over time, (b) mean and standard deviation of growth rate for
subsamples of entire time series, and (c) the percent error between mean
estimated growth rate and the true long-term growth rate. The vertical
bar denotes the minimum time required to estimate growth rate within
20\% error.\label{fig:growth_rate}}
\end{figure}


\begin{figure}[htbp]
\centering
\caption{Histogram of the minimum time required in order to estimate the
long-term growth rate within 20\%
error.\label{fig:min_time_growth_dist}}
\end{figure}

\begin{figure}[htbp]
\centering
\caption{(a) Time series for Bigeye tuna (\emph{Thunnus obesus}) with
corresponding fitted GAM model in red and (b) statistical power as a
function of the number of years sampled. The horizontal line at 0.8
indicates the minimum threshold for statistical power and the vertical
line denotes the minimum time required to achieve 0.8 statistical
power.\label{fig:gam_example}}
\end{figure}

\begin{figure}[htbp]
\centering
\caption{Distribution of the minimum time required in order to detect a
significant trend (at the 0.05 level) in abundance according to a GAM
model given statistical power of 0.8. The smoothing parameter was set to
3 for each population.\label{fig:min_time_dist_gam}}
\end{figure}